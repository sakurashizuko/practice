<!--
    THIS EXAMPLE WAS DOWNLOADED FROM https://echarts.apache.org/examples/zh/editor.html?c=line-smooth
-->
<!DOCTYPE html>
<html style="height: 100%">

<head>
  <meta charset="utf-8">
</head>

<body style="height: 100%; margin: 0">
<div id="container" style="height: 98%"></div>
<div id="weightReign" style="height: 2%">
  <div>
    <label> Today Weight:<input id="weight" type="text"/></label>
    <label> Today eat:<input id="eat" type="text"/></label>
    <label> Today burn:<input id="burn" type="text"/></label>
    <label> Today study:<input id="study" type="text"/></label>
    <label>
      <button onclick="saveWeight()">提交</button>
      <input id="hw" type="hidden"/>
    </label>
  </div>

</div>

<!--

<script type="text/javascript" src=  "https://cdn.staticfile.org/echarts/4.3.0/echarts.min.js"></script>
-->
<script src="http://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js" type="text/javascript"></script>
<script src="echarts.min.js" type="text/javascript"></script>
<script type="text/javascript">
  function saveWeight() {
    const weight = document.getElementById('weight').value;
    const eat = document.getElementById('eat').value;
    const burn = document.getElementById('burn').value;
    const study = document.getElementById('study').value;
    const url = "http://localhost:8081/weight/saveTodayWeight/" + weight + "/" + eat + "/" + burn
        + "/" + study;

    $.ajax({
      type: "get",
      async: false,
      url: url,
      success: function (data) {
        // var input = document.createElement('input');
        // input.setAttribute('readonly', 'readonly');
        // input.setAttribute('value', data);
        // document.body.appendChild(input);
        // input.select();
        // input.setSelectionRange(0, 9999);
        // document.execCommand('Copy');
        // if (document.execCommand('Copy')) {
        // }
        var inputNode = document.createElement('textarea');
        inputNode.value = data;
        document.body.appendChild(inputNode);
        inputNode.select();
        inputNode.setSelectionRange(0, 9999);
        document.execCommand('copy')
        if (document.execCommand('Copy')) {
          // alert("success!")
        }
      },
      error: function (errorMsg) {
        alert(errorMsg);
      }
    });

    location.reload();
  }

  var dates = [];
  var weights = [];
  $.ajax({
    type: "get",
    async: false,
    url: "http://localhost:8081/weight/getRecords",
    dataType: "json",        //返回数据形式为json
    success: function (data) {
      for (var i = 0; i < data.length; i++) {
        dates.push(data[i].recordTime);    //挨个取出类别并填入类别数组
        weights.push(data[i].weight);    //挨个取出类别并填入类别数组

      }

    },
    error: function (errorMsg) {
      console.info(errorMsg);
    }
  });

  var dom = document.getElementById("container");
  var myChart = echarts.init(dom);
  var minNum = Math.ceil(weights[0]);

  for (let num of weights) {
    var weight = Math.ceil(num);
    if (weight < minNum) {
      minNum = weight;
    }
  }
  var option;
  option = {
    // 标题
    title: {
      text: '多条折线图测试用例', // 标题名称
    },
    // x轴
    xAxis: {
      data:
      // x轴坐标名称
      dates

    },
    // y轴
    yAxis: {
      // min: 54
      min: minNum - 5

    },
    // 提示框，鼠标悬浮交互时的信息提示
    tooltip: {
      show: true, // 是否显示
      trigger: 'axis', // 触发类型，默认数据触发，见下图，可选为：'item' | 'axis'
    },
    legend: {
      data: ['current_weight']
    },
    // 指定图标的类型
    series: [
      // 第一条折线图
      {
        name: 'current_weight', // 系列名称
        type: 'line', // 类型：线
        // 数据
        data: weights,
        smooth: true,
        itemStyle: {
          normal: {
            color: '#ff22c0', //改变折线点的颜色
            lineStyle: {
              color: '#ff22c0' //改变折线颜色
            }
          }
        },

        markPoint: {
          // 标注图形数据
          data: [{
            type: 'max', // 类型
            symbol: 'pin', // 标志图形类型，默认自动选择（8种类型循环使用，不显示标志图形可设为'none'），默认循环选择类型有：'circle' | 'rectangle' | 'triangle' | 'diamond' |'emptyCircle' | 'emptyRectangle' | 'emptyTriangle' | 'emptyDiamond' 另外，还支持五种更特别的标志图形'heart'（心形）、'droplet'（水滴）、'pin'（标注）、'arrow'（箭头）和'star'（五角星），这并不出现在常规的8类图形中，但无论是在系列级还是数据级上你都可以指定使用，同时，'star' + n（n>=3)可变化出N角星，如指定为'star6'则可以显示6角星
            name: 'max'
          },
            {
              type: 'min', // 类型
              symbol: 'pin',
              name: 'min'
            },
          ],
          // 特殊标注文字
          label: {
            normal: {
              show: true,
              //position: 'top', // 文字位置
              // 显示的文字
              formatter: '{b}：{c}',
            }
          },
          // 触发操作
          tooltip: {
            show: true, // 是否显示
            formatter: '{b}：{c}', // 内容格式器 a（系列名称），b（类目值），c（数值）, d（无）
            trigger: 'item', // 触发类型，默认数据触发，见下图，可选为：'item' | 'axis'
          },
        },
        markLine: {
          data: [{
            type: 'average',
            name: '平均值',
            itemStyle: {
              normal: {
                color: 'green'
              }
            }
          }]
        },
        // 折线图圆点
        label: {
          normal: {
            show: false,
            //position: 'bottom', // 文字位置
            // 显示的文字
            formatter: '{c}',
            textStyle: {
              color: '#000000' // 文字颜色
            }
          }
        },
      }
    ]

  };
  if (option && typeof option === 'object') {
    myChart.setOption(option);
  }

</script>

</body>

</html>
